(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{25:function(e,t,r){"use strict";(function(e){r.d(t,"a",(function(){return h}));r(42);var n=r(0),a=r(26),o=r(27),i=r(30);function u(e){return(u="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function l(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=p(e);if(t){var a=p(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return f(this,r)}}function f(e,t){return!t||"object"!==u(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var h=function(t){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(p,t);var r,n,u,f=l(p);function p(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,p),(t=f.call(this,e)).state={showExportPanel:!1},t.player=new a.a(document.createElement("canvas")),t.player.on("load",(function(){var e=t.player.noteFormat;"KWZ"===e?t.player.resize(320,240):"PPM"===e&&t.player.resize(256,192),t.setState({showExportPanel:!0})})),window.flipnote=t.player,t}return r=p,(n=[{key:"handleFileUpload",value:function(e){this.loadFlipnote(e[0])}},{key:"handleUrl",value:function(e){this.loadFlipnote(e)}},{key:"loadFlipnote",value:function(e){this.setState({showExportPanel:!1}),this.player.load(e)}},{key:"unloadFlipnote",value:function(){this.player.closeNote(),this.setState({showExportPanel:!1})}},{key:"render",value:function(){var t=this,r=(this.props,this.state);return e.createElement("div",{className:"Layout"},!r.showExportPanel&&e.createElement(o.a,{onUpload:function(e){return t.handleFileUpload(e)},onLoadUrl:function(e){return t.handleUrl(e)}}),r.showExportPanel&&e.createElement(i.a,{onExit:function(){return t.unloadFlipnote()},player:this.player}))}}])&&s(r.prototype,n),u&&s(r,u),p}(n.Component)}).call(this,r(0))},27:function(e,t,r){"use strict";(function(e){r.d(t,"a",(function(){return p}));var n=r(0),a=r(38),o=r(29);function i(e){return(i="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=f(e);if(t){var a=f(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return l(this,r)}}function l(e,t){return!t||"object"!==i(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function f(e){return(f=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var p=function(t){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&s(e,t)}(f,t);var r,n,i,l=c(f);function f(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,f),(t=l.call(this,e)).state={flipnoteUrl:""},t}return r=f,(n=[{key:"loadUrl",value:function(){var e=this.state.flipnoteUrl;e&&(e=Object(o.a)(e),this.props.onLoadUrl(e))}},{key:"render",value:function(){var t=this;return e.createElement("div",{className:"Card Card--introduction"},e.createElement("div",{className:"Card__body"},e.createElement("header",{className:"Hero"},e.createElement("h1",{className:"Hero__title"},"FlipClip"),e.createElement("p",{className:"Hero__sub"},"A small utility to convert animations from ",e.createElement("a",{target:"_blank",href:"https://en.wikipedia.org/wiki/Flipnote_Studio"},"Flipnote Studio")," or ",e.createElement("a",{target:"_blank",href:"https://en.wikipedia.org/wiki/Flipnote_Studio_3D"},"Flipnote Studio 3D")," into the ",e.createElement("a",{target:"_blank",href:"https://calcium-chan.itch.io/clipnote"},"Clipnote")," format.")),e.createElement(a.a,{className:"Dropzone",accept:[".ppm",".kwz"],onDrop:function(e){return t.props.onUpload(e)}},(function(t){var r=t.getRootProps,n=t.getInputProps;return e.createElement("section",null,e.createElement("div",r({className:"Dropzone"}),e.createElement("input",n()),e.createElement("p",{className:"Dropzone__prompt"},"Drag & drop a Flipnote Studio .PPM or .KWZ file here"),e.createElement("span",{className:"Button Dropzone__button"},e.createElement("i",{className:"uil uil-file"}),"Browse Files")))})),e.createElement("div",{className:"FormGroup"},e.createElement("div",{className:"FormElement"},e.createElement("label",{htmlFor:"flipnoteUrl"},"Or paste a URL from ",e.createElement("a",{target:"_blank",href:"https://gallery.kaeru.world/"},"Kaeru Gallery")," or ",e.createElement("a",{target:"_blank",href:"https://ipgflip.xyz"},"IPGFlip")),e.createElement("input",{className:"Input TextInput",id:"flipnoteUrl",type:"text",value:this.state.flipnoteUrl,onChange:function(e){return t.setState({flipnoteUrl:e.target.value})}})),e.createElement("button",{type:"button",className:"Button",onClick:function(e){return t.loadUrl()}},"Load")),e.createElement("div",{className:"Meta"},"Built by ",e.createElement("a",{target:"_blank",href:"https://jamesdaniel.dev"},"James Daniel"),", source code is on ",e.createElement("a",{target:"_blank",href:"https://github.com/jaames/flipclip"},"GitHub"),".")))}}])&&u(r.prototype,n),i&&u(r,i),f}(n.Component)}).call(this,r(0))},29:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=/https?:\/\/gallery.kaeru.world\/memo\/([0-9a-z]{28})/,a=/https?:\/\/(?:www.)?ipgflip.xyz\/watch\/([0-9A-F]{6}_[0-9A-F]{13}_[0-9]{3})/;function o(e){return n.test(e)?e.replace(n,(function(e,t){return"https://cdn.kaeru.world/memo/kwz/".concat(t,".kwz")})):a.test(e)?e.replace(a,(function(e,t){return"https://content.ipgflip.xyz/movie/".concat(t,".ppm")})):e}},30:function(e,t,r){"use strict";(function(e){r.d(t,"a",(function(){return w}));var n=r(2),a=r.n(n),o=r(0),i=r(31),u=r(32),s=r(35),c=r(36),l=r.n(c);function f(e){return(f="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(e,t,r,n,a,o,i){try{var u=e[o](i),s=u.value}catch(c){return void r(c)}u.done?t(s):Promise.resolve(s).then(n,a)}function h(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){p(o,n,a,i,u,"next",e)}function u(e){p(o,n,a,i,u,"throw",e)}i(void 0)}))}}function y(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function m(e,t){return(m=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function v(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=b(e);if(t){var a=b(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return d(this,r)}}function d(e,t){return!t||"object"!==f(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var g=new u.a,w=function(t){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&m(e,t)}(c,t);var r,n,o,u=v(c);function c(e){var t;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(t=u.call(this,e)).player=e.player;var r=t.player.note.meta;return t.state={progress:0,isConvertionInProgress:!1,inputType:t.player.note.type,outputName:"".concat(r.current.filename,".clip"),userId:"",frameColor:"#ffffff",usePaper:!0},t}return r=c,(n=[{key:"setStateSynchronously",value:function(e){var t=this;return new Promise((function(r){t.setState(e,(function(){setInterval(r,0)}))}))}},{key:"convert",value:function(){var e=h(a.a.mark((function e(){var t=this;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.state.isConvertionInProgress){e.next=2;break}return e.abrupt("return",null);case 2:return e.next=4,this.setStateSynchronously({progress:0,progressStatus:"Preparing...",isConvertionInProgress:!0});case 4:return e.next=6,g.init({frameColor:this.state.frameColor,usePaper:this.state.usePaper});case 6:return e.next=8,g.loadSource(this.player.note);case 8:return e.next=10,this.setStateSynchronously({progressStatus:"Converting metadata..."});case 10:return e.next=12,g.writeMeta();case 12:return e.next=14,this.setStateSynchronously({progressStatus:"Converting audio..."});case 14:return e.next=16,g.writeAudio();case 16:return e.next=18,this.setStateSynchronously({progressStatus:"Converting frames..."});case 18:return e.next=20,g.writeLayers(function(){var e=h(a.a.mark((function e(r){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.setStateSynchronously({progress:r});case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 20:return e.next=22,this.setStateSynchronously({progressStatus:"Converting thumbnail..."});case 22:return e.next=24,g.writeThumb();case 24:return e.next=26,this.setStateSynchronously({progress:0,progressStatus:"Done!",isConvertionInProgress:!1});case 26:g.finish((function(e){var r=t.state.outputName.match(/(\S+)\.clip/),n=r?r[1]:"note";Object(s.saveAs)(e,"".concat(n,".clip"))}));case 27:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var t=this,r=this.props,n=this.state,a=this.player.note.meta;return e.createElement("div",{className:"Card Card--exportPanel"},e.createElement("div",{className:"Card__head Nav"},e.createElement("a",{className:"Nav__left",onClick:function(e){return!n.isConvertionInProgress&&r.onExit()}},e.createElement("i",{className:"uil uil-arrow-left"}),"Return"),e.createElement("span",{className:"Nav__title"},"Convert"),e.createElement("span",{className:"Nav__right"})),e.createElement("div",{className:"Card__body"},e.createElement("label",null,"Preview"),e.createElement("div",{className:"FlipnoteInfo"},e.createElement("h3",null,"Flipnote by ",a.current.username)),e.createElement(i.a,{backgroundColor:n.frameColor,player:this.player,disabled:n.isConvertionInProgress}),e.createElement("div",{className:"FormGroup"},"PPM"===n.inputType&&e.createElement("div",{className:"FormElement"},e.createElement("label",{htmlFor:"frameColor"},"Frame color"),e.createElement("input",{className:"Input ColorInput",id:"frameColor",type:"color",value:n.frameColor,disabled:n.isConvertionInProgress,onChange:function(e){return t.setState({frameColor:e.target.value})}})),e.createElement("div",{className:"FormElement"},e.createElement("label",{htmlFor:"usePaper"},"Use paper background"),e.createElement(l.a,{className:"SwitchInput",onClick:function(e){return t.setState({usePaper:!n.usePaper})},on:n.usePaper}))),e.createElement("div",{className:"FormGroup"},e.createElement("div",{className:"FormElement"},e.createElement("label",{htmlFor:"outputName"},"Filename"),e.createElement("input",{className:"Input TextInput",id:"outputName",type:"text",value:n.outputName,disabled:n.isConvertionInProgress,onChange:function(e){return t.setState({outputName:e.target.value})}})),e.createElement("button",{type:"button",className:"Button",disabled:n.isConvertionInProgress,onClick:function(e){return t.convert()}},"Convert"))),e.createElement("div",{className:"Card__foot"},e.createElement("div",{className:"Progress"},e.createElement("span",{className:"Progress__status"},n.progressStatus),e.createElement("div",{className:"Progress__bar"},e.createElement("div",{className:"Progress__level",style:{width:"".concat(n.progress,"%")}})))))}}])&&y(r.prototype,n),o&&y(r,o),c}(o.Component)}).call(this,r(0))},31:function(e,t,r){"use strict";(function(e){r.d(t,"a",(function(){return l}));var n=r(0);function a(e){return(a="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var r,n=c(e);if(t){var a=c(this).constructor;r=Reflect.construct(n,arguments,a)}else r=n.apply(this,arguments);return s(this,r)}}function s(e,t){return!t||"object"!==a(t)&&"function"!==typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var l=function(t){!function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(c,t);var r,n,a,s=u(c);function c(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(t=s.call(this,e)).state={paused:!0},t.props.player.on("playback:end",(function(){t.onPlaybackEnd()})),t}return r=c,(n=[{key:"componentDidMount",value:function(){this.player=this.props.player,this._wasPlaying=!1,this._canvasWrapper.appendChild(this.player.canvasEl)}},{key:"componentWillUnmount",value:function(){this._canvasWrapper.removeChild(this.player.canvasEl),this._wasPlaying=!1,this.player=null}},{key:"componentDidUpdate",value:function(e){var t=this.props;!1===e.disabled&&!0===t.disabled?(this._wasPlaying=!1===this.state.paused,this.pause()):!0===e.disabled&&!1===t.disabled&&this._wasPlaying&&this.play()}},{key:"play",value:function(){var e=this.player;e.play(),this.setState({paused:e.paused})}},{key:"pause",value:function(){var e=this.player;e.pause(),this.setState({paused:e.paused})}},{key:"togglePlay",value:function(){this.state.paused?this.play():this.pause()}},{key:"onPlaybackEnd",value:function(){this.setState({paused:!0})}},{key:"render",value:function(){var t=this,r=this.props,n=this.state,a=r.player.noteFormat;return e.createElement("div",{className:"Player Player--".concat(a," ").concat(r.disabled?"disabled":"")},e.createElement("div",{className:"Player__canvasBox"},e.createElement("div",{className:"Player__canvas",ref:function(e){return t._canvasWrapper=e},style:{background:r.backgroundColor}})),e.createElement("div",{className:"Player__controls"},e.createElement("i",{className:"uil uil-backward",onClick:function(e){return t.player.firstFrame()}}),e.createElement("i",{className:"uil uil-step-backward",onClick:function(e){return t.player.prevFrame()}}),e.createElement("i",{className:"uil uil-".concat(n.paused?"play":"pause"),onClick:function(){return t.togglePlay()}}),e.createElement("i",{className:"uil uil-skip-forward",onClick:function(e){return t.player.nextFrame()}}),e.createElement("i",{className:"uil uil-forward",onClick:function(e){return t.player.lastFrame()}})))}}])&&o(r.prototype,n),a&&o(r,a),c}(n.Component)}).call(this,r(0))},32:function(e,t,r){"use strict";r.d(t,"a",(function(){return v}));var n=r(2),a=r.n(n),o=r(33),i=r.n(o),u=r(34),s=r.n(u);function c(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"===typeof Symbol||!(Symbol.iterator in Object(e)))return;var r=[],n=!0,a=!1,o=void 0;try{for(var i,u=e[Symbol.iterator]();!(n=(i=u.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(s){a=!0,o=s}finally{try{n||null==u.return||u.return()}finally{if(a)throw o}}return r}(e,t)||function(e,t){if(!e)return;if("string"===typeof e)return l(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return l(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function f(e,t,r,n,a,o,i){try{var u=e[o](i),s=u.value}catch(c){return void r(c)}u.done?t(s):Promise.resolve(s).then(n,a)}function p(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var o=e.apply(t,r);function i(e){f(o,n,a,i,u,"next",e)}function u(e){f(o,n,a,i,u,"throw",e)}i(void 0)}))}}function h(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var y=[[255,255,255,255],[0,0,0,255],[255,23,23,255],[255,230,0,255],[0,130,50,255],[0,60,200,255],[255,255,255,0]],m=[[255,255,255,255],[0,0,0,255],[255,23,23,255],[0,60,200,255]],v=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e);var r=document.createElement("canvas");r.width=320,r.height=240;var n=r.getContext("2d");this.canvas=r,this.ctx=n,this._hasLoadedVorbisLib=!1,this.usePaper=!0,this.frameColor=null,t&&this.loadSource(t),window.exporter=this}var t,r,n;return t=e,(r=[{key:"init",value:function(){var e=p(a.a.mark((function e(t){var r,n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.usePaper,n=t.frameColor,this.usePaper=r,this.frameColor=n,this._hasLoadedVorbisLib){e.next=10;break}return e.next=6,s()("/flipclip//lib/libvorbis.min.js");case 6:return this._hasLoadedVorbisLib=!0,e.abrupt("return",!0);case 10:return e.abrupt("return",!0);case 11:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"loadSource",value:function(){var e=p(a.a.mark((function e(t){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.output=new i.a,this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.source=t,this.sourceType=t.format,"KWZ"===this.sourceType?(this.source.globalPalette=y,this.sourceWidth=320,this.sourceHeight=240):"PPM"===this.sourceType&&(this.source.globalPalette=m,this.sourceWidth=256,this.sourceHeight=192),this.pixelBuffer=new Uint32Array(this.sourceWidth*this.sourceHeight),this.palette=new Uint32Array(8),this.frame=null,this._currentFrame=-1,e.abrupt("return",!0);case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"finish",value:function(e){this.output.generateAsync({type:"blob"}).then(e)}},{key:"writeMeta",value:function(){var e=p(a.a.mark((function e(){var t,r,n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.source,r=t.meta,n=["[user]",'id="FLIPNOTE"','name="'.concat(r.current.username,'"'),"[data]",'spinoff="'.concat(r.current.fsid===r.parent.fsid?0:1,'"'),'locked="'.concat(r.lock,'"'),'framerate="'.concat(t.framerate,'"'),'frame_max="'.concat(t.frameCount,'"'),'replay="'.concat(r.loop,'"')].join("\n"),this.output.file("data.ini",n),e.abrupt("return",!0);case 5:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"writeThumb",value:function(){var e=p(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.getFrameData(this.source.thumbFrameIndex),this.output.file("thumb.png",t,{base64:!0}),e.abrupt("return",!0);case 3:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"writeAudio",value:function(){var e=this;return new Promise((function(t,r){var n=e.source;if("undefined"!==typeof window.VorbisEncoder){var a=n.sampleRate,o=new VorbisEncoder,i=[];o.ondata=function(e){i.push(e)},o.onfinish=function(){var r=new Blob(i,{type:"audio/ogg"});e.output.file("sound.ogg",r),t()};var u=n.getAudioMasterPcm(),s=new Float32Array(u.length);u.forEach((function(e,t){s[t]=e/32767})),o.init(1,a,.75),o.encode([s.buffer],s.length,1),o.finish()}else t()}))}},{key:"writeLayers",value:function(e){var t=this,r=this.source.frameCount,n="KWZ"===this.sourceType?3:2,o=r*n,i=0,u=function(){var r=p(a.a.mark((function r(s){var c,l,f;return a.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!(i>=o)){r.next=6;break}return r.next=3,e(100);case 3:s(),r.next=14;break;case 6:return c=Math.floor(i/n),l=i%n,t.writeLayer(c,l),f=i/o*100,r.next=12,e(f);case 12:i+=1,u(s);case 14:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}();return new Promise((function(e,t){u(e)}))}},{key:"writeLayer",value:function(){var e=p(a.a.mark((function e(t,r){var n,o,i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"PPM"===this.sourceType?o=(n=[1,0]).length-r-1:"KWZ"===this.sourceType&&(n=this.source.getFrameLayerOrder(t).reverse(),o=n.length-r-1,r=n[r]),i=this.getLayerData(t,r,this.usePaper&&0===o),this.output.file("".concat(t,",").concat(o,".png"),i,{base64:!0}),e.abrupt("return",!0);case 4:case"end":return e.stop()}}),e,this)})));return function(t,r){return e.apply(this,arguments)}}()},{key:"_loadFramePalette",value:function(e){var t=this;this.source.getFramePalette(e).forEach((function(e,r){var n=c(e,3),a=n[0],o=n[1],i=n[2];t.palette[r]=255<<24|i<<16|o<<8|a}))}},{key:"_pixelBufferToImageData",value:function(){var e=new ImageData(new Uint8ClampedArray(this.pixelBuffer.buffer),this.sourceWidth,this.sourceHeight);return"PPM"===this.sourceType?this.ctx.putImageData(e,32,24):"KWZ"===this.sourceType&&this.ctx.putImageData(e,0,0),this.canvas.toDataURL().split(",")[1]}},{key:"_clearPixelBuffer",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this.pixelBuffer.fill(e)}},{key:"_clearCanvas",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=function(e){return e.toString(16).padStart(2,"0")};if(e){if(Array.isArray(e)){var r=255&e,n=e>>8&255,a=e>>16&255,o="#"+t(r)+t(n)+t(a);this.ctx.fillStyle=o}else"string"===typeof e&&(this.ctx.fillStyle=e);this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height)}else this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)}},{key:"getFrameData",value:function(e){this._loadFramePalette(e);var t=this.source.getFramePixels(e);this._clearCanvas(this.frameColor?this.frameColor:this.palette[0]),this._clearPixelBuffer(this.palette[0]);for(var r=0;r<t.length;r++){var n=t[r];0!==n&&(this.pixelBuffer[r]=this.palette[n])}return this._pixelBufferToImageData()}},{key:"getLayerData",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this._loadFramePalette(e);var n=this.source.getLayerPixels(e,t);r?(this._clearCanvas(this.frameColor?this.frameColor:this.palette[0]),this._clearPixelBuffer(this.palette[0])):(this._clearCanvas(),this._clearPixelBuffer());for(var a=0;a<n.length;a++){var o=n[a];0!==o&&(this.pixelBuffer[a]=this.palette[o])}return this._pixelBufferToImageData()}}])&&h(t.prototype,r),n&&h(t,n),e}()},39:function(e,t,r){e.exports=r(40)},40:function(e,t,r){"use strict";r.r(t),function(e){var t=r(25),n=r(37);Object(n.render)(e.createElement(t.a,null),document.getElementById("app"))}.call(this,r(0))},42:function(e,t,r){},48:function(e,t){},50:function(e,t){}},[[39,2,0]]]);